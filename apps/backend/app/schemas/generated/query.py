# generated by datamodel-codegen:
#   filename:  query.json
#   timestamp: 2026-02-09T14:47:04+00:00

from __future__ import annotations

from enum import Enum
from uuid import UUID

from pydantic import AwareDatetime, BaseModel, Field, conint, constr


class IntentOverride(Enum):
    QA = 'QA'
    ANALYSIS = 'ANALYSIS'
    AUDIT = 'AUDIT'


class GraphRAGRequest(BaseModel):
    query: constr(min_length=1) = Field(..., description="User's natural language question")
    document_ids: list[UUID] | None = Field(
        None, description='Specific documents to query (None = all workflow docs)'
    )
    include_sources: bool | None = True
    max_context_tokens: conint(ge=1000, le=32000) | None = 8000
    intent_override: IntentOverride | None = None


class SourceCitation(BaseModel):
    citation_id: str
    document_name: str
    document_id: UUID
    page_numbers: list[int] | None = None
    section_type: str
    relationship_context: str | None = None


class ResponseMetadata(BaseModel):
    intent: str
    traversal_depth: int
    vector_results_count: int
    graph_results_count: int
    merged_results_count: int
    full_text_count: int
    summary_count: int
    total_context_tokens: int
    latency_ms: int
    stage_latencies: dict[str, int] | None = None
    graph_available: bool | None = True
    fallback_mode: bool | None = False


class GraphRAGResponse(BaseModel):
    answer: str
    sources: list[SourceCitation] | None = None
    metadata: ResponseMetadata
    timestamp: AwareDatetime
